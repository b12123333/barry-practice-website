"use strict";(self["webpackChunkbarry"]=self["webpackChunkbarry"]||[]).push([[32],{561:function(t,r,e){e.d(r,{r:function(){return n}});var s=e(3907),c=e(6252);const n=t=>{const r=(0,s.oR)(),e=r.state.cartList,n=(t,e,s,c)=>{r.commit("changeCartItemInfo",{shopId:t,productId:e,productInfo:s,num:c})},a=(0,c.Fl)((()=>{const r=e[t]?.productList||{},s={};for(const t in r){const e=r[t];e.count>0&&(s[t]=e)}return s})),o=(0,c.Fl)((()=>{const r=e[t]?.shopName||"";return r})),i=(0,c.Fl)((()=>{const r=e[t]?.productList,s={total:0,price:0,allChecked:!0};if(r)for(const t in r){const e=r[t];s.total+=e.count,e.check&&(s.price+=e.count*e.price),e.count>0&&!e.check&&(s.allChecked=!1)}return s.price=s.price.toFixed(2),s}));return{shopName:o,cartList:e,changeCartItemInfo:n,productList:a,calculations:i}}},8909:function(t,r,e){e.r(r),e.d(r,{default:function(){return tt}});var s=e(6252);const c={class:"wrapper"};function n(t,r,e,n,a,o){const i=(0,s.up)("TopArea"),_=(0,s.up)("ProductList"),d=(0,s.up)("Order");return(0,s.wg)(),(0,s.iD)("div",c,[(0,s.Wm)(i),(0,s.Wm)(_),(0,s.Wm)(d)])}const a={class:"top"},o={class:"top__header"},i=(0,s._)("span",{class:"top__hearder__back"},"確認訂單",-1),_=(0,s.uE)('<div class="top__receiver"><div class="top__receiver__title">收貨地址</div><div class="top__receiver__address">北京理工大學國防科學園2號樓10層</div><div class="top__receiver__info"><span class="top__receiver__info__name">蘇先生</span><span class="top__receiver__info__name">0920936276</span></div><div class="top__receiver__icon icofont-rounded-left"></div></div>',1);function d(t,r,e,c,n,d){return(0,s.wg)(),(0,s.iD)("div",a,[(0,s._)("div",o,[(0,s._)("span",{class:"top__hearder__icon icofont-rounded-left",onClick:r[0]||(r[0]=(...t)=>c.handleBackClick&&c.handleBackClick(...t))}),i]),_])}var l=e(2119),p={name:"TopArea",setup(){const t=(0,l.tv)(),r=()=>{t.back()};return{handleBackClick:r}}},u=e(3744);const m=(0,u.Z)(p,[["render",d]]);var v=m,h=e(3577);const f=t=>((0,s.dD)("data-v-591f2870"),t=t(),(0,s.Cn)(),t),k={class:"products"},C={class:"products__title"},w={class:"products__wrapper"},I={class:"products__list"},b={key:0,class:"product__item"},L=["src"],O={class:"product__item__detail"},g={class:"product__item__title"},y={class:"product__item__price"},D={class:"product__item__yen"},N={class:"product__item__total"},z=f((()=>(0,s._)("span",{class:"product__item__yen"},"¥",-1)));function F(t,r,e,c,n,a){return(0,s.wg)(),(0,s.iD)("div",k,[(0,s._)("div",C,(0,h.zw)(c.shopName),1),(0,s._)("div",w,[(0,s._)("div",I,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.productList,(t=>((0,s.wg)(),(0,s.iD)(s.HY,{key:t.id},[t.count>0?((0,s.wg)(),(0,s.iD)("div",b,[(0,s._)("img",{class:"product__item__img",src:t.imgUrl},null,8,L),(0,s._)("div",O,[(0,s._)("h4",g,(0,h.zw)(t.name),1),(0,s._)("p",y,[(0,s._)("span",D,"¥"+(0,h.zw)(t.price)+" x "+(0,h.zw)(t.count),1),(0,s._)("span",N,[z,(0,s.Uk)(" "+(0,h.zw)((t.price*t.count).toFixed(2)),1)])])])])):(0,s.kq)("",!0)],64)))),128))])])])}var S=e(561),H={name:"ProductList",setup(){const t=(0,l.yj)(),r=t.params.id,{shopName:e,productList:s}=(0,S.r)(r);return{shopName:e,productList:s}}};const Z=(0,u.Z)(H,[["render",F],["__scopeId","data-v-591f2870"]]);var x=Z,A=e(9963);const B=t=>((0,s.dD)("data-v-3d53d208"),t=t(),(0,s.Cn)(),t),P={class:"order"},T={class:"order__price"},U=(0,s.Uk)("實付金額 "),W=B((()=>(0,s._)("h3",{class:"mask__content__title"},"確認要離開收銀",-1))),Y=B((()=>(0,s._)("p",{class:"mask__content__desc"},"完成支付，否則將取消訂單",-1))),j={class:"mask__content__btns"};function R(t,r,e,c,n,a){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",P,[(0,s._)("div",T,[U,(0,s._)("b",null,"¥ "+(0,h.zw)(c.calculations.price),1)]),(0,s._)("div",{class:"order__btn",onClick:r[0]||(r[0]=t=>c.handleSummitOrder(!0))},"提交訂單")]),(0,s.wy)((0,s._)("div",{class:"mask",onClick:r[4]||(r[4]=t=>c.handleSummitOrder(!1))},[(0,s._)("div",{class:"mask__content",onClick:r[3]||(r[3]=(0,A.iM)((()=>{}),["stop"]))},[W,Y,(0,s._)("div",j,[(0,s._)("div",{class:"mask__content__btn mask__content__btn--first",onClick:r[1]||(r[1]=()=>c.handleConfirmOrder(!0))},"取消訂單 "),(0,s._)("div",{class:"mask__content__btn mask__content__btn--last",onClick:r[2]||(r[2]=()=>c.handleConfirmOrder(!1))},"確認支付 ")])])],512),[[A.F8,c.showConfirm]])],64)}var q=e(2262),E=e(3907),K=e(4471);const M=(t,r,e)=>{const s=(0,l.tv)(),c=(0,E.oR)(),n=async n=>{const a=[];for(const t in e.value){const r=e.value[t];a.push({id:parseInt(r._id,10),num:parseInt(r.count,10)})}try{const e=await(0,K.v)("/api/order",{addressId:1,shopId:t,shopName:r.value,isCanceled:n,products:a});0===e.errno&&(c.commit("ClearCartData",t),s.push({name:"orderList"}))}catch(o){alert("下單失敗")}};return{handleConfirmOrder:n}},G=()=>{const t=(0,q.iH)(!1),r=r=>{t.value=r};return{handleSummitOrder:r,showConfirm:t}};var J={name:"Order",setup(){const t=(0,l.yj)(),r=parseInt(t.params.id,10),{calculations:e,shopName:s,productList:c}=(0,S.r)(r),{handleConfirmOrder:n}=M(r,s,c),{handleSummitOrder:a,showConfirm:o}=G();return{calculations:e,handleConfirmOrder:n,handleSummitOrder:a,showConfirm:o}}};const Q=(0,u.Z)(J,[["render",R],["__scopeId","data-v-3d53d208"]]);var V=Q,X={name:"orderconfirmation",components:{TopArea:v,ProductList:x,Order:V}};const $=(0,u.Z)(X,[["render",n],["__scopeId","data-v-1dde3422"]]);var tt=$}}]);
//# sourceMappingURL=orderConfirmation.b8ce6686.js.map