"use strict";(self["webpackChunkbarry"]=self["webpackChunkbarry"]||[]).push([[152],{561:function(t,c,e){e.d(c,{r:function(){return n}});var a=e(3907),s=e(6252);const n=t=>{const c=(0,a.oR)(),e=c.state.cartList,n=(t,e,a,s)=>{c.commit("changeCartItemInfo",{shopId:t,productId:e,productInfo:a,num:s})},o=(0,s.Fl)((()=>{const c=e[t]?.productList||{},a={};for(const t in c){const e=c[t];e.count>0&&(a[t]=e)}return a})),r=(0,s.Fl)((()=>{const c=e[t]?.shopName||"";return c})),i=(0,s.Fl)((()=>{const c=e[t]?.productList,a={total:0,price:0,allChecked:!0};if(c)for(const t in c){const e=c[t];a.total+=e.count,e.check&&(a.price+=e.count*e.price),e.count>0&&!e.check&&(a.allChecked=!1)}return a.price=a.price.toFixed(2),a}));return{shopName:r,cartList:e,changeCartItemInfo:n,productList:o,calculations:i}}},3525:function(t,c,e){e.d(c,{Z:function(){return k}});var a=e(6252),s=e(3577);const n={class:"shop"},o=["src"],r={class:"shop__content__title"},i={class:"shop__content__tags"},_={class:"shop__content__tag"},l={class:"shop__content__tag"},d={class:"shop__content__tag"},u={class:"shop__content__hightlight"};function p(t,c,e,p,h,m){return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("img",{class:"shop__img",src:e.item.imgUrl},null,8,o),(0,a._)("div",{class:(0,s.C_)({shop__content:!0,"shop__content--bordered":!e.hideBorder})},[(0,a._)("div",r,(0,s.zw)(e.item.name),1),(0,a._)("div",i,[(0,a._)("span",_," 月售: "+(0,s.zw)(e.item.sales),1),(0,a._)("span",l," 起送: "+(0,s.zw)(e.item.expressLimit),1),(0,a._)("span",d," 基礎運費: "+(0,s.zw)(e.item.expressPrice),1)]),(0,a._)("div",u,(0,s.zw)(e.item.slogan),1)],2)])}var h={name:"shopinfo",props:["item","hideBorder"]},m=e(3744);const C=(0,m.Z)(h,[["render",p],["__scopeId","data-v-5c9b7876"]]);var k=C},2377:function(t,c,e){e.r(c),e.d(c,{default:function(){return bt}});var a=e(6252),s=e(9963);const n=t=>((0,a.dD)("data-v-afe1b43c"),t=t(),(0,a.Cn)(),t),o={class:"wrapper"},r={class:"search"},i=n((()=>(0,a._)("div",{class:"search__content"},[(0,a._)("span",{class:"icofont-search"}),(0,a._)("input",{class:"search__content__input",placeholder:"請輸入商品名稱"})],-1)));function _(t,c,e,n,_,l){const d=(0,a.up)("shopinfo"),u=(0,a.up)("shopcontent"),p=(0,a.up)("cart");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("div",r,[(0,a._)("div",{class:"search__back icofont-rounded-left",onClick:c[0]||(c[0]=(...t)=>n.handleBackClick&&n.handleBackClick(...t))}),i]),(0,a.wy)((0,a.Wm)(d,{item:n.item,hideBorder:!0},null,8,["item"]),[[s.F8,n.item.imgUrl]]),(0,a.Wm)(u,{shopName:n.item.name},null,8,["shopName"]),(0,a.Wm)(p)])}var l=e(3525),d=e(3577);const u=t=>((0,a.dD)("data-v-189e253e"),t=t(),(0,a.Cn)(),t),p={class:"content"},h={class:"category"},m=["onClick"],C={class:"product"},k=["src"],g={class:"product__item__detail"},v={class:"product__item__title"},I={class:"product__item__sales"},w={class:"product__item__price"},f=u((()=>(0,a._)("span",{class:"product__item__yen"},"¥",-1))),b={class:"product__item__origin"},y={class:"product__number"},D=["onClick"],z={class:"product__number__count"},L=["onClick"];function P(t,c,e,s,n,o){return(0,a.wg)(),(0,a.iD)("div",p,[(0,a._)("div",h,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.categories,(t=>((0,a.wg)(),(0,a.iD)("div",{class:(0,d.C_)({category__item:!0,"category__item--active":s.currentTab===t.tab}),key:t.name,onClick:()=>s.handleTabClick(t.tab)},(0,d.zw)(t.name),11,m)))),128))]),(0,a._)("div",C,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.list,(t=>((0,a.wg)(),(0,a.iD)("div",{class:"product__item",key:t._id},[(0,a._)("img",{class:"product__item__img",src:t.imgUrl},null,8,k),(0,a._)("div",g,[(0,a._)("h4",v,(0,d.zw)(t.name),1),(0,a._)("p",I,"月售"+(0,d.zw)(t.sales)+"份",1),(0,a._)("p",w,[f,(0,a.Uk)((0,d.zw)(t.price)+" ",1),(0,a._)("span",b,"¥"+(0,d.zw)(t.oldPrice),1)])]),(0,a._)("div",y,[(0,a._)("span",{class:"product__number__minus",onClick:()=>{s.changeCartItem(s.shopId,t._id,t,-1,e.shopName)}}," -",8,D),(0,a._)("span",z,(0,d.zw)(s.getProductCartCount(s.shopId,t._id)),1),(0,a._)("span",{class:"product__number__plus",onClick:()=>{s.changeCartItem(s.shopId,t._id,t,1,e.shopName)}}," +",8,L)])])))),128))])])}var U=e(2262),N=e(2119),B=e(4471),S=e(3907),T=e(561);const H=[{name:"全部商品",tab:"all"},{name:"秒殺",tab:"seckill"},{name:"新鲜水果",tab:"fruit"}],F=()=>{const t=(0,U.iH)(H[0].tab),c=c=>{t.value=c};return{currentTab:t,handleTabClick:c}},Z=(t,c)=>{const e=(0,U.qj)({list:[]}),s=async()=>{const a=await(0,B.U)(`/api/shop/${c}/products`,{tab:t.value});0===a?.errno&&a?.data?.length&&(e.list=a.data)};(0,a.m0)((()=>{s()}));const{list:n}=(0,U.BK)(e);return{list:n}},j=()=>{const t=(0,S.oR)(),{cartList:c,changeCartItemInfo:e}=(0,T.r)(),a=(c,e)=>{t.commit("changeShopName",{shopId:c,shopName:e})},s=(t,c,s,n,o)=>{e(t,c,s,n),a(t,o)},n=(t,e)=>c[t]?.productList?.[e]?.count||0;return{cartList:c,changeCartItem:s,getProductCartCount:n}};var q={name:"Content",props:["shopName"],setup(){const t=(0,N.yj)(),c=t.params.id,{currentTab:e,handleTabClick:a}=F(),{list:s}=Z(e,c),{changeCartItem:n,cartList:o,getProductCartCount:r}=j();return{categories:H,currentTab:e,handleTabClick:a,list:s,shopId:c,changeCartItem:n,cartList:o,getProductCartCount:r}}},K=e(3744);const Y=(0,K.Z)(q,[["render",P],["__scopeId","data-v-189e253e"]]);var W=Y;const x=t=>((0,a.dD)("data-v-115b9848"),t=t(),(0,a.Cn)(),t),R={class:"cart"},$={key:0,class:"product"},A={class:"product__header"},E=(0,a.Uk)(" 全選 "),G={class:"product__header__clear"},J={key:0,class:"product__item"},M=["onClick"],O=["src"],Q={class:"product__item__detail"},V={class:"product__item__title"},X={class:"product__item__price"},tt=x((()=>(0,a._)("span",{class:"product__item__yen"},"¥",-1))),ct={class:"product__item__origin"},et={class:"product__number"},at=["onClick"],st=["onClick"],nt={class:"check"},ot={class:"check__icon"},rt={class:"check__icon__tag"},it={class:"check__info"},_t=(0,a.Uk)(" 總計："),lt={class:"check__info__price"},dt={class:"check__btn"},ut=(0,a.Uk)(" 結算 ");function pt(t,c,e,n,o,r){const i=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)(a.HY,null,[n.showCart&&n.calculations.total>0?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"mask",onClick:c[0]||(c[0]=(...t)=>n.handleCartShowChange&&n.handleCartShowChange(...t))})):(0,a.kq)("",!0),(0,a._)("div",R,[n.showCart&&n.calculations.total>0?((0,a.wg)(),(0,a.iD)("div",$,[(0,a._)("div",A,[(0,a._)("div",{class:"product__header__all",onClick:c[1]||(c[1]=()=>n.setCartItemsChecked(n.shopId))},[(0,a._)("span",{class:(0,d.C_)(["product__header__icon",{"icofont-check-circled":n.calculations.allChecked,"icofont-close-circled":!n.calculations.allChecked}])},null,2),E]),(0,a._)("div",G,[(0,a._)("span",{class:"product__header__clear__btn",onClick:c[2]||(c[2]=()=>n.cleanCartProducts(n.shopId))}," 清空購物車")])]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.productList,(t=>((0,a.wg)(),(0,a.iD)(a.HY,{key:t._id},[t.count>0?((0,a.wg)(),(0,a.iD)("div",J,[(0,a._)("div",{class:(0,d.C_)(["product__item__checked",{"icofont-check-circled":t.check,"icofont-close-circled":!t.check}]),onClick:()=>n.changeCartItemChecked(n.shopId,t._id)},null,10,M),(0,a._)("img",{class:"product__item__img",src:t.imgUrl},null,8,O),(0,a._)("div",Q,[(0,a._)("h4",V,(0,d.zw)(t.name),1),(0,a._)("p",X,[tt,(0,a.Uk)((0,d.zw)(t.price)+" ",1),(0,a._)("span",ct,"¥"+(0,d.zw)(t.oldPrice),1)])]),(0,a._)("div",et,[(0,a._)("span",{class:"product__number__minus",onClick:()=>{n.changeCartItemInfo(n.shopId,t._id,t,-1)}},"-",8,at),(0,a.Uk)(" "+(0,d.zw)(t.count||0)+" ",1),(0,a._)("span",{class:"product__number__plus",onClick:()=>{n.changeCartItemInfo(n.shopId,t._id,t,1)}},"+",8,st)])])):(0,a.kq)("",!0)],64)))),128))])):(0,a.kq)("",!0),(0,a._)("div",nt,[(0,a._)("div",ot,[(0,a._)("img",{src:"http://www.dell-lee.com/imgs/vue3/basket.png",class:"check__icon__img",onClick:c[3]||(c[3]=(...t)=>n.handleCartShowChange&&n.handleCartShowChange(...t))}),(0,a._)("div",rt,(0,d.zw)(n.calculations.total),1)]),(0,a._)("div",it,[_t,(0,a._)("span",lt,"¥ "+(0,d.zw)(n.calculations.price),1)]),(0,a.wy)((0,a._)("div",dt,[(0,a.Wm)(i,{to:{path:`/orderconfirmation/${n.shopId}`}},{default:(0,a.w5)((()=>[ut])),_:1},8,["to"])],512),[[s.F8,n.calculations.total>0]])])])],64)}const ht=t=>{const c=(0,S.oR)(),{productList:e,calculations:a,changeCartItemInfo:s}=(0,T.r)(t),n=(t,e)=>{c.commit("changeCartItemChecked",{shopId:t,productId:e})},o=t=>{c.commit("cleanCartProducts",{shopId:t})},r=t=>{c.commit("setCartItemsChecked",{shopId:t})};return{calculations:a,productList:e,cleanCartProducts:o,changeCartItemInfo:s,changeCartItemChecked:n,setCartItemsChecked:r}},mt=()=>{const t=(0,U.iH)(!1),c=()=>{t.value=!t.value};return{showCart:t,handleCartShowChange:c}};var Ct={name:"Cart",setup(){const t=(0,N.yj)(),c=t.params.id,{showCart:e,handleCartShowChange:a}=mt(),{calculations:s,productList:n,cleanCartProducts:o,allChecked:r,changeCartItemInfo:i,changeCartItemChecked:_,setCartItemsChecked:l}=ht(c);return{calculations:s,shopId:c,productList:n,cleanCartProducts:o,changeCartItemInfo:i,changeCartItemChecked:_,allChecked:r,setCartItemsChecked:l,showCart:e,handleCartShowChange:a}}};const kt=(0,K.Z)(Ct,[["render",pt],["__scopeId","data-v-115b9848"]]);var gt=kt;const vt=()=>{const t=(0,N.yj)(),c=(0,U.qj)({item:{}}),e=async()=>{const e=await(0,B.U)(`/api/shop/${t.params.id}`);0===e.errno&&e.data&&(c.item=e.data)},{item:a}=(0,U.BK)(c);return{item:a,getItemData:e}},It=()=>{const t=(0,N.tv)(),c=()=>{t.back()};return c};var wt={name:"shop",components:{shopinfo:l.Z,shopcontent:W,cart:gt},setup(){const{item:t,getItemData:c}=vt(),e=It();return c(),{item:t,handleBackClick:e}}};const ft=(0,K.Z)(wt,[["render",_],["__scopeId","data-v-afe1b43c"]]);var bt=ft}}]);
//# sourceMappingURL=shop_1.abab4d3d.js.map